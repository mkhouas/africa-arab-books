<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø±ØµØ¯ Ø§Ù„ÙƒØªØ¨ Ù„Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø§ÙØ±ÙŠÙ‚ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</title>
<meta name="description" content="Ù…Ø±ØµØ¯ Ù…ØªØ®ØµØµ ÙŠØ¬Ù…Ø¹ Ø£Ø­Ø¯Ø« Ø§Ù„ÙƒØªØ¨ Ø­ÙˆÙ„ Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ© ÙˆØ§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙˆØ§Ù„ÙØ±Ù†Ø³ÙŠØ© â€” Ù…Ù† +120 Ù…ØµØ¯Ø± Ù…Ø­Ù„ÙŠ ÙˆØ¯ÙˆÙ„ÙŠ">
<style>
 * { margin:0; padding:0; box-sizing:border-box; }
 :root {
 --bg: #f0f2f5;
 --card: #ffffff;
 --text: #1a1a2e;
 --text2: #555;
 --accent: #0d7377;
 --accent2: #14919b;
 --gold: #d4a017;
 --ar: #059669;
 --fr: #2563eb;
 --en: #7c3aed;
 --shadow: 0 2px 20px rgba(0,0,0,.06);
 --radius: 16px;
 }
 body {
 font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
 background: var(--bg);
 color: var(--text);
 line-height: 1.6;
 min-height: 100vh;
 }
 /* â”€â”€ Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© â”€â”€ */
 .hero {
 background: linear-gradient(135deg, #0d1117 0%, #0d7377 50%, #14919b 100%);
 color: white;
 padding: 40px 20px;
 text-align: center;
 position: relative;
 overflow: hidden;
 }
 .hero::before {
 content: '';
 position: absolute;
 top: -50%;
 left: -50%;
 width: 200%;
 height: 200%;
 background: radial-gradient(circle, rgba(255,255,255,.03) 0%, transparent 70%);
 animation: pulse 8s ease-in-out infinite;
 }
 @keyframes pulse {
 0%,100% { transform: scale(1); }
 50% { transform: scale(1.1); }
 }
 .hero h1 { font-size: 2.2em; font-weight: 800; position: relative; }
 .hero p { font-size: 1.1em; opacity: .85; margin-top: 8px; position: relative; }

 /* â”€â”€ Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª â”€â”€ */
 .stats-bar {
 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
 gap: 12px;
 max-width: 1400px;
 margin: -30px auto 0;
 padding: 0 20px;
 position: relative;
 z-index: 2;
 }
 .stat-card {
 background: var(--card);
 border-radius: var(--radius);
 padding: 20px 16px;
 text-align: center;
 box-shadow: var(--shadow);
 border: 1px solid rgba(0,0,0,.04);
 }
 .stat-card .num { font-size: 1.8em; font-weight: 800; }
 .stat-card .lbl { font-size: .8em; color: var(--text2); margin-top: 2px; }

 /* â”€â”€ Ø§Ù„ÙÙ„Ø§ØªØ± â”€â”€ */
 .controls {
 max-width: 1400px;
 margin: 24px auto;
 padding: 0 20px;
 display: flex;
 flex-wrap: wrap;
 gap: 12px;
 align-items: center;
 }
 .search-box {
 flex: 1;
 min-width: 250px;
 padding: 12px 20px;
 border-radius: 50px;
 border: 2px solid #e0e0e0;
 font-size: 1em;
 outline: none;
 transition: border .3s;
 direction: rtl;
 }
 .search-box:focus { border-color: var(--accent); }

 .filter-btn {
 padding: 10px 22px;
 border-radius: 50px;
 border: 2px solid #e0e0e0;
 background: var(--card);
 cursor: pointer;
 font-size: .9em;
 font-weight: 600;
 transition: all .3s;
 }
 .filter-btn:hover { border-color: var(--accent); color: var(--accent); }
 .filter-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
 .filter-btn.active-ar { background: var(--ar); color: white; border-color: var(--ar); }
 .filter-btn.active-fr { background: var(--fr); color: white; border-color: var(--fr); }
 .filter-btn.active-en { background: var(--en); color: white; border-color: var(--en); }

 /* â”€â”€ Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­Ø¯ÙŠØ« â”€â”€ */
 .update-bar {
 max-width: 1400px;
 margin: 0 auto 16px;
 padding: 0 20px;
 display: flex;
 justify-content: space-between;
 align-items: center;
 flex-wrap: wrap;
 gap: 8px;
 }
 .update-bar span { font-size: .85em; color: var(--text2); }
 .update-bar .live {
 display: flex;
 align-items: center;
 gap: 6px;
 font-size: .85em;
 color: var(--accent);
 font-weight: 600;
 }
 .live-dot {
 width: 8px;
 height: 8px;
 background: #10b981;
 border-radius: 50%;
 animation: blink 2s ease-in-out infinite;
 }
 @keyframes blink { 0%,100%{opacity:1;} 50%{opacity:.3;} }

 .refresh-btn {
 padding: 8px 20px;
 border-radius: 50px;
 border: none;
 background: var(--accent);
 color: white;
 cursor: pointer;
 font-size: .85em;
 font-weight: 600;
 transition: background .3s;
 }
 .refresh-btn:hover { background: var(--accent2); }
 .refresh-btn:disabled { opacity: .5; cursor: not-allowed; }

 /* â”€â”€ Ø´Ø¨ÙƒØ© Ø§Ù„ÙƒØªØ¨ â”€â”€ */
 .books-grid {
 max-width: 1400px;
 margin: 0 auto;
 padding: 0 20px 40px;
 display: grid;
 grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
 gap: 20px;
 }

 /* â”€â”€ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙƒØªØ§Ø¨ â”€â”€ */
 .book-card {
 background: var(--card);
 border-radius: var(--radius);
 overflow: hidden;
 box-shadow: var(--shadow);
 border: 1px solid rgba(0,0,0,.04);
 transition: transform .3s, box-shadow .3s;
 display: flex;
 flex-direction: column;
 }
 .book-card:hover {
 transform: translateY(-4px);
 box-shadow: 0 8px 30px rgba(0,0,0,.12);
 }

 .book-cover-wrap {
 position: relative;
 height: 220px;
 background: linear-gradient(135deg, #1a1a2e, #16213e);
 display: flex;
 align-items: center;
 justify-content: center;
 overflow: hidden;
 }
 .book-cover-wrap img {
 height: 190px;
 max-width: 140px;
 object-fit: cover;
 border-radius: 6px;
 box-shadow: 4px 4px 20px rgba(0,0,0,.4);
 transition: transform .3s;
 }
 .book-card:hover .book-cover-wrap img { transform: scale(1.05); }

 .lang-badge {
 position: absolute;
 top: 12px;
 right: 12px;
 padding: 4px 14px;
 border-radius: 20px;
 font-size: .75em;
 font-weight: 700;
 color: white;
 }
 .lang-ar { background: var(--ar); }
 .lang-fr { background: var(--fr); }
 .lang-en { background: var(--en); }

 .source-badge {
 position: absolute;
 bottom: 10px;
 left: 10px;
 padding: 3px 10px;
 border-radius: 10px;
 font-size: .65em;
 background: rgba(255,255,255,.15);
 color: rgba(255,255,255,.8);
 backdrop-filter: blur(4px);
 }

 .book-body {
 padding: 18px;
 flex: 1;
 display: flex;
 flex-direction: column;
 }

 .book-title {
 font-size: 1.05em;
 font-weight: 700;
 line-height: 1.5;
 display: -webkit-box;
 -webkit-line-clamp: 2;
 -webkit-box-orient: vertical;
 overflow: hidden;
 margin-bottom: 8px;
 }
 .book-author {
 font-size: .9em;
 color: var(--accent);
 font-weight: 600;
 margin-bottom: 4px;
 }
 .book-publisher {
 font-size: .82em;
 color: var(--text2);
 margin-bottom: 8px;
 }
 .book-meta {
 display: flex;
 flex-wrap: wrap;
 gap: 12px;
 font-size: .78em;
 color: var(--text2);
 margin-bottom: 10px;
 }
 .book-meta span { display: flex; align-items: center; gap: 4px; }

 .book-topics {
 display: flex;
 flex-wrap: wrap;
 gap: 6px;
 margin-bottom: 12px;
 }
 .topic-tag {
 padding: 3px 12px;
 border-radius: 20px;
 font-size: .72em;
 background: #f0f7f7;
 color: var(--accent);
 font-weight: 500;
 }

 .book-desc {
 font-size: .82em;
 color: var(--text2);
 line-height: 1.6;
 display: -webkit-box;
 -webkit-line-clamp: 3;
 -webkit-box-orient: vertical;
 overflow: hidden;
 margin-bottom: 12px;
 }

 .book-actions {
 margin-top: auto;
 display: flex;
 gap: 8px;
 }
 .btn-link {
 flex: 1;
 padding: 10px;
 text-align: center;
 border-radius: 12px;
 font-size: .85em;
 font-weight: 600;
 text-decoration: none;
 transition: all .3s;
 }
 .btn-primary {
 background: var(--text);
 color: white;
 }
 .btn-primary:hover { background: var(--accent); }
 .btn-secondary {
 background: #f5f5f5;
 color: var(--text);
 border: 1px solid #e0e0e0;
 }
 .btn-secondary:hover { background: #eee; }

 /* â”€â”€ Ø§Ù„ØªØ­Ù…ÙŠÙ„ â”€â”€ */
 .loader {
 text-align: center;
 padding: 60px;
 grid-column: 1 / -1;
 }
 .spinner {
 width: 50px;
 height: 50px;
 border: 4px solid #e0e0e0;
 border-top-color: var(--accent);
 border-radius: 50%;
 animation: spin 1s linear infinite;
 margin: 0 auto 16px;
 }
 @keyframes spin { to { transform: rotate(360deg); } }

 .no-results {
 text-align: center;
 padding: 60px;
 grid-column: 1 / -1;
 color: var(--text2);
 }
 .no-results .emoji { font-size: 4em; margin-bottom: 12px; }

 /* â”€â”€ Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ‚Ø¯Ù… â”€â”€ */
 .progress-bar {
 max-width: 1400px;
 margin: 0 auto 12px;
 padding: 0 20px;
 }
 .progress-track {
 height: 4px;
 background: #e0e0e0;
 border-radius: 4px;
 overflow: hidden;
 }
 .progress-fill {
 height: 100%;
 background: linear-gradient(90deg, var(--accent), var(--accent2));
 border-radius: 4px;
 transition: width .5s;
 }
 .progress-text {
 font-size: .78em;
 color: var(--text2);
 margin-top: 4px;
 text-align: center;
 }

 /* â”€â”€ Footer â”€â”€ */
 footer {
 text-align: center;
 padding: 30px 20px;
 font-size: .8em;
 color: var(--text2);
 border-top: 1px solid #e0e0e0;
 max-width: 1400px;
 margin: 0 auto;
 }

 .sources-toggle {
 background: none;
 border: 1px solid #ddd;
 padding: 6px 16px;
 border-radius: 20px;
 cursor: pointer;
 font-size: .85em;
 margin-top: 8px;
 color: var(--accent);
 font-weight: 600;
 }
 .sources-list {
 display: none;
 max-width: 1200px;
 margin: 12px auto;
 text-align: right;
 font-size: .78em;
 color: var(--text2);
 line-height: 2;
 columns: 3;
 column-gap: 30px;
 padding: 0 20px;
 }
 .sources-list.open { display: block; }

 @media (max-width: 768px) {
 .hero h1 { font-size: 1.5em; }
 .books-grid { grid-template-columns: 1fr; }
 .stats-bar { grid-template-columns: repeat(3, 1fr); }
 .sources-list { columns: 1; }
 }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="hero">
 <h1>ğŸ“š Ù…Ø±ØµØ¯ Ø§Ù„ÙƒØªØ¨ Ù„Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø§ÙØ±ÙŠÙ‚ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h1>
 <p>ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙŠÙˆÙ…ÙŠ Ù…Ù† +120 Ù…ØµØ¯Ø± Ù…Ø­Ù„ÙŠ ÙˆØ¯ÙˆÙ„ÙŠ â€” Ø§Ù„ÙƒØªØ¨ ØªØ¨Ù‚Ù‰ Ù„Ù…Ø¯Ø© Ø¹Ø§Ù… Ù…Ù† ØªØ§Ø±ÙŠØ® Ù†Ø´Ø±Ù‡Ø§</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="stats-bar" id="statsBar">
 <div class="stat-card"><div class="num" id="totalCount">-</div><div class="lbl">ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒØªØ¨</div></div>
 <div class="stat-card"><div class="num" id="arCount" style="color:var(--ar)">-</div><div class="lbl">ğŸ‡¸ğŸ‡¦ Ø¹Ø±Ø¨ÙŠ</div></div>
 <div class="stat-card"><div class="num" id="frCount" style="color:var(--fr)">-</div><div class="lbl">ğŸ‡«ğŸ‡· ÙØ±Ù†Ø³ÙŠ</div></div>
 <div class="stat-card"><div class="num" id="enCount" style="color:var(--en)">-</div><div class="lbl">ğŸ‡¬ğŸ‡§ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</div></div>
 <div class="stat-card"><div class="num" id="sourceCount" style="color:var(--gold)">-</div><div class="lbl">ğŸ“¡ Ø§Ù„Ù…Ø±Ø§ØµØ¯</div></div>
 <div class="stat-card"><div class="num" id="pubCount">-</div><div class="lbl">ğŸ¢ Ø§Ù„Ù†Ø§Ø´Ø±ÙˆÙ†</div></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø§Ù„ÙÙ„Ø§ØªØ± â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="controls">
 <input type="text" class="search-box" id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒØªØ§Ø¨ØŒ Ù…Ø¤Ù„ÙØŒ Ø£Ùˆ Ù†Ø§Ø´Ø± ..." oninput="filterBooks()">
 <button class="filter-btn active" onclick="setLang('all',this)">Ø§Ù„ÙƒÙ„</button>
 <button class="filter-btn" onclick="setLang('ar',this)">ğŸ‡¸ğŸ‡¦ Ø¹Ø±Ø¨ÙŠ</button>
 <button class="filter-btn" onclick="setLang('fr',this)">ğŸ‡«ğŸ‡· ÙØ±Ù†Ø³ÙŠ</button>
 <button class="filter-btn" onclick="setLang('en',this)">ğŸ‡¬ğŸ‡§ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</button>
 <select class="search-box" style="flex:none;width:200px;border-radius:50px" id="topicSelect" onchange="filterBooks()">
 <option value="">ğŸ“‚ ÙƒÙ„ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹</option>
 <option value="Africa">Ø£ÙØ±ÙŠÙ‚ÙŠØ§</option>
 <option value="North Africa">Ø´Ù…Ø§Ù„ Ø£ÙØ±ÙŠÙ‚ÙŠØ§</option>
 <option value="Sahel">Ø§Ù„Ø³Ø§Ø­Ù„</option>
 <option value="Arab">Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ</option>
 <option value="Middle East">Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·</option>
 <option value="Gulf">Ø§Ù„Ø®Ù„ÙŠØ¬</option>
 <option value="Sudan">Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</option>
 <option value="Migration">Ø§Ù„Ù‡Ø¬Ø±Ø©</option>
 <option value="Security">Ø§Ù„Ø£Ù…Ù†</option>
 <option value="Development">Ø§Ù„ØªÙ†Ù…ÙŠØ©</option>
 <option value="Politics">Ø§Ù„Ø³ÙŠØ§Ø³Ø©</option>
 </select>
 <select class="search-box" style="flex:none;width:180px;border-radius:50px" id="sortSelect" onchange="filterBooks()">
 <option value="date">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
 <option value="title">Ø£Ø¨Ø¬Ø¯ÙŠ (Ø§Ù„Ø¹Ù†ÙˆØ§Ù†)</option>
 <option value="pages">Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª</option>
 </select>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­Ø¯ÙŠØ« â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="update-bar">
 <div class="live"><span class="live-dot"></span> ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙŠÙˆÙ…ÙŠ</div>
 <span id="lastUpdate">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
 <button class="refresh-btn" id="refreshBtn" onclick="manualRefresh()">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ù…Ø¤Ø´Ø± Ø§Ù„ØªÙ‚Ø¯Ù… â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="progress-bar" id="progressBar" style="display:none">
 <div class="progress-track"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
 <div class="progress-text" id="progressText">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¬Ù„Ø¨ Ù…Ù† Ø§Ù„Ù…Ø±Ø§ØµØ¯...</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø´Ø¨ÙƒØ© Ø§Ù„ÙƒØªØ¨ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="books-grid" id="booksGrid">
 <div class="loader"><div class="spinner"></div><p>Ø¬Ø§Ø±Ù Ø¬Ù„Ø¨ Ø§Ù„ÙƒØªØ¨ Ù…Ù† Ø§Ù„Ù…Ø±Ø§ØµØ¯...</p></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Footer â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<footer>
 <p>Ù…Ø±ØµØ¯ Ø§Ù„ÙƒØªØ¨ Ù„Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø§ÙØ±ÙŠÙ‚ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Â© 2025-2026</p>
 <p>ÙŠØ¬Ù…Ø¹ Ø§Ù„ÙƒØªØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ù‘Ø§ Ù…Ù† Google BooksØŒ Open LibraryØŒ CrossrefØŒ DOAB Ùˆ+120 Ù…ØµØ¯Ø±Ù‹Ø§ Ù…Ø­Ù„ÙŠÙ‹Ù‘Ø§ ÙˆØ¯ÙˆÙ„ÙŠÙ‹Ù‘Ø§</p>
 <button class="sources-toggle" onclick="toggleSources()">ğŸ“š Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§ØµØ¯ Ø§Ù„Ù€ +120</button>
 <div class="sources-list" id="sourcesList"></div>
</footer>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ â€” ÙƒØªØ¨ Ø£ÙØ±ÙŠÙ‚ÙŠØ© ÙˆØ¹Ø±Ø¨ÙŠØ© (+120 Ù…ØµØ¯Ø±)
// ØªØ¨Ù‚Ù‰ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø© ÙÙŠ Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø­ØªÙ‰ ÙŠÙ…Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ø¹Ø§Ù… Ø¹Ù„Ù‰ Ù†Ø´Ø±Ù‡Ø§
// Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙŠÙˆÙ…ÙŠ (ÙƒÙ„ 24 Ø³Ø§Ø¹Ø©)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let ALL_BOOKS = [];
let currentLang = 'all';

// Ù…Ø¯Ø© Ø§Ù„ÙƒØ§Ø´: 24 Ø³Ø§Ø¹Ø© (ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯)
const CACHE_DURATION = 24 * 60 * 60 * 1000; // 86400000 ms

// â”€â”€â”€ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§ØµØ¯ Ø§Ù„Ù…ÙˆØ³Ù‘Ø¹Ø© â”€â”€â”€ (120+)
const SOURCES_LIST = [
 // APIs Ø¹Ø§Ù…Ø©
 "Google Books API","Open Library API","Crossref API","DOAB (Open Access Books)",
 "OAPEN Library","OpenAlex","Semantic Scholar","WorldCat",
 // Ù…Ø±Ø§ÙƒØ² Ø¨Ø­Ø«ÙŠØ© Ø£ÙØ±ÙŠÙ‚ÙŠØ©
 "African Studies Centre Leiden (ASC)","Nordic Africa Institute","Institute of African Studies, Ghana",
 "Council for the Development of Social Science Research in Africa (CODESRIA)",
 "African Economic Research Consortium (AERC)","Institute for Security Studies (ISS) - Pretoria",
 "South African Institute of International Affairs (SAIIA)","Institute for Pan-African Thought and Conversation",
 "African Leadership Centre, King's College London","Centre for Conflict Resolution (CCR) - Cape Town",
 "Institute of Development Studies Nairobi","Makerere Institute of Social Research (MISR)",
 "African Population and Health Research Center (APHRC)","West African Research Center (WARC)",
 "Centre for African Literary Studies, KwaZulu-Natal","Institute for African Studies, Moscow",
 // Ù…Ø±Ø§ÙƒØ² Ø¨Ø­Ø«ÙŠØ© Ø¹Ø±Ø¨ÙŠØ©
 "Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù„Ù„Ø£Ø¨Ø­Ø§Ø« ÙˆØ¯Ø±Ø§Ø³Ø© Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª (Ø§Ù„Ø¯ÙˆØ­Ø©)","Ù…Ø±ÙƒØ² Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ø¨ÙŠØ±ÙˆØª)",
 "Ù…Ø±ÙƒØ² Ø§Ù„Ø£Ù‡Ø±Ø§Ù… Ù„Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø³ÙŠØ© ÙˆØ§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©","Ù…Ø¹Ù‡Ø¯ Ø§Ù„Ø¯ÙˆØ­Ø© Ù„Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø¹Ù„ÙŠØ§",
 "Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…ØºØ±Ø¨ÙŠ Ù„Ù„Ø¯Ø±Ø§Ø³Ø§Øª ÙˆØ§Ù„Ø£Ø¨Ø­Ø§Ø« Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©","Ù…Ø±ÙƒØ² Ø§Ù„Ø¬Ø²ÙŠØ±Ø© Ù„Ù„Ø¯Ø±Ø§Ø³Ø§Øª",
 "Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø¯ÙŠÙ…Ù‚Ø±Ø§Ø·ÙŠ Ø§Ù„Ø¹Ø±Ø¨ÙŠ","Ù…Ø±ÙƒØ² ÙƒØ§Ø±Ù†ÙŠØºÙŠ Ù„Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·","Ù…Ø±ÙƒØ² Ø¨Ø±ÙˆÙƒÙ†Ø¬Ø² Ø§Ù„Ø¯ÙˆØ­Ø©",
 "Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„Ù…ØµØ±ÙŠ Ù„Ù„Ø¯Ø±Ø§Ø³Ø§Øª","Ù…Ø±ÙƒØ² Ø§Ù„Ø¨Ø­ÙˆØ« ÙˆØ§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø³ÙŠØ© (Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©)",
 "Ù…Ø¹Ù‡Ø¯ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ (Ø¨Ø§Ø±ÙŠØ³)","Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù„Ø£Ø¨Ø­Ø§Ø« Ø§Ù„ÙØ¶Ø§Ø¡ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
 // Ø¬Ø§Ù…Ø¹Ø§Øª Ø£ÙØ±ÙŠÙ‚ÙŠØ© - Ø¯ÙˆØ± Ø§Ù„Ù†Ø´Ø±
 "Cairo University Press","American University in Cairo Press","University of Cape Town Press",
 "Wits University Press (Johannesburg)","Makerere University Press","University of Ghana Publishing",
 "University of Nairobi Press","University of Ibadan Press","Addis Ababa University Press",
 "University of Dar es Salaam Press","University of Pretoria Press","Kwame Nkrumah University Press",
 "UniversitÃ© Cheikh Anta Diop (Dakar) Publications","Bayero University Press (Kano)",
 // Ø¯ÙˆØ± Ù†Ø´Ø± Ø£ÙØ±ÙŠÙ‚ÙŠØ© Ù…Ø­Ù„ÙŠØ©
 "Langaa Research & Publishing (Cameroon)","Mkuki na Nyota Publishers (Tanzania)",
 "NISC (Pty) Ltd (South Africa)","Jacana Media (South Africa)","Cassava Republic Press (Nigeria)",
 "Kwani? (Kenya)","African Books Collective (ABC)","Sefsafa Publishing House (Cairo)",
 "Africultures (Paris/Senegal)","Africa World Press","East African Educational Publishers",
 // Ø¯ÙˆØ± Ù†Ø´Ø± Ø¹Ø±Ø¨ÙŠØ© Ù…Ø­Ù„ÙŠØ©
 "Ø¯Ø§Ø± Ø§Ù„Ø´Ø±ÙˆÙ‚ (Ù…ØµØ±)","Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ù…ØµØ±ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ÙƒØªØ§Ø¨","Ø¯Ø§Ø± Ø§Ù„Ù…Ø¹Ø§Ø±Ù (Ù…ØµØ±)",
 "Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ù‚ÙŠ (Ø¨ÙŠØ±ÙˆØª)","Ø¯Ø§Ø± Ø§Ù„Ø¢Ø¯Ø§Ø¨ (Ø¨ÙŠØ±ÙˆØª)","Ø¯Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø± (Ø¨ÙŠØ±ÙˆØª)","Ø¯Ø§Ø± Ø§Ù„ÙØ§Ø±Ø§Ø¨ÙŠ (Ø¨ÙŠØ±ÙˆØª)",
 "Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„Ø¯Ø±Ø§Ø³Ø§Øª ÙˆØ§Ù„Ù†Ø´Ø±","Ø¯Ø§Ø± Ø§Ù„Ø·Ù„ÙŠØ¹Ø© (Ø¨ÙŠØ±ÙˆØª)","Ø¯Ø§Ø± Ø±ÙŠØ§Ø¶ Ø§Ù„Ø±ÙŠØ³",
 "Ø¯Ø§Ø± Ø§Ù„Ø¬Ù…Ù„ (Ø£Ù„Ù…Ø§Ù†ÙŠØ§/Ø¨ÙŠØ±ÙˆØª)","Ø¯Ø§Ø± Ø§Ù„ØªÙ†ÙˆÙŠØ± (ØªÙˆÙ†Ø³/Ù…ØµØ±/Ù„Ø¨Ù†Ø§Ù†)","Ø¯Ø§Ø± Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ (ØªÙˆÙ†Ø³)",
 "Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„Ø´Ø±Ù‚ (Ø§Ù„Ù…ØºØ±Ø¨)","Ø¯Ø§Ø± Ø£Ø¨ÙŠ Ø±Ù‚Ø±Ø§Ù‚ (Ø§Ù„Ù…ØºØ±Ø¨)","Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ø²Ù…Ù† (Ø§Ù„Ù…ØºØ±Ø¨)",
 "Ø¯Ø§Ø± ØªÙˆØ¨Ù‚Ø§Ù„ (Ø§Ù„Ù…ØºØ±Ø¨)","Ø¯Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ø¨ÙŠØ±ÙˆØª)","Ø¯Ø§Ø± Ø§Ø¨Ù† Ø§Ù„Ù†Ø¯ÙŠÙ… (Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±)",
 "Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ø¬Ù…Ù„ (Ø£Ù„Ù…Ø§Ù†ÙŠØ§)","Ø¯Ø§Ø± Ø§Ù„Ø±Ø§ÙØ¯ÙŠÙ† (Ø¨ÙŠØ±ÙˆØª/Ø¨ØºØ¯Ø§Ø¯)","Ø¯Ø§Ø± Ø§Ù„Ø­ÙˆØ§Ø± (Ø³ÙˆØ±ÙŠØ§)",
 "Ø¯Ø§Ø± Ø§Ù„ÙŠÙ†Ø§Ø¨ÙŠØ¹ (Ø¯Ù…Ø´Ù‚)","Ø¯Ø§Ø± Ø§Ù„ÙÙƒØ± (Ø¯Ù…Ø´Ù‚)","Ø¯Ø§Ø± Ø§Ù„Ø­ØµØ§Ø¯ (Ø¯Ù…Ø´Ù‚)",
 "Ø§Ù„Ø£Ù‡Ù„ÙŠØ© Ù„Ù„Ù†Ø´Ø± ÙˆØ§Ù„ØªÙˆØ²ÙŠØ¹ (Ø§Ù„Ø£Ø±Ø¯Ù†)","Ø¯Ø§Ø± Ø§Ù„Ø´Ø±ÙˆÙ‚ (Ø§Ù„Ø£Ø±Ø¯Ù†)","Ø¯Ø§Ø± ÙˆØ±Ø¯ (Ø§Ù„Ø£Ø±Ø¯Ù†)",
 "Ø¯Ø§Ø± Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ (Ø¨ÙŠØ±ÙˆØª)","Ø§Ù„Ø¯Ø§Ø± Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„Ø¹Ù„ÙˆÙ… Ù†Ø§Ø´Ø±ÙˆÙ†","Ø¯Ø§Ø± Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ø¹Ù„Ù…ÙŠØ© (Ø¨ÙŠØ±ÙˆØª)",
 "Ù…Ø¯Ø§Ø±Ø§Øª Ù„Ù„Ø£Ø¨Ø­Ø§Ø« ÙˆØ§Ù„Ù†Ø´Ø± (Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©)","Ø¯Ø§Ø± Ø§Ù„Ø¹ÙŠÙ† Ù„Ù„Ù†Ø´Ø± (Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©)","Ø¯Ø§Ø± Ù…ÙŠØ±ÙŠØª (Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©)",
 "Ø¯Ø§Ø± Ø§Ù„ÙƒØ±Ù…Ø© (Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©)","Ø¯Ø§Ø± Ù†Ù‡Ø¶Ø© Ù…ØµØ±","Ø¯Ø§Ø± Ø§Ù„ÙÙƒØ± Ø§Ù„Ø¹Ø±Ø¨ÙŠ (Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©)",
 // Ù†Ø§Ø´Ø±ÙˆÙ† Ø¯ÙˆÙ„ÙŠÙˆÙ† Ù…ØªØ®ØµØµÙˆÙ†
 "Oxford University Press (African Studies)","Cambridge University Press (Middle East Studies)",
 "Pluto Press","Zed Books","I.B. Tauris","Hurst Publishers","James Currey (Boydell & Brewer)",
 "Lynne Rienner Publishers","Palgrave Macmillan (African Studies)",
 // Ù†Ø§Ø´Ø±ÙˆÙ† ÙØ±Ù†Ø³ÙŠÙˆÙ† Ù…ØªØ®ØµØµÙˆÙ†
 "Karthala","La DÃ©couverte","L'Harmattan","CNRS Ã‰ditions","Ã‰ditions de l'EHESS",
 "Presses de Sciences Po","Maisonneuve & Larose","Ã‰ditions du Seuil",
 // Ù…Ù†ØµØ§Øª Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©
 "JSTOR","Project MUSE","OpenEdition Books","Cairn.info","SAGE Publications"
];

// â”€â”€â”€ Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ÙˆØ³Ù‘Ø¹Ø© â”€â”€â”€
const QUERIES = {
 en: [
 "africa politics 2025","african development 2024",
 "arab world affairs 2025","middle east politics",
 "sahel security crisis","maghreb north africa",
 "horn africa ethiopia somalia","east africa kenya tanzania",
 "west africa nigeria ghana","southern africa south africa",
 "central africa congo","sudan conflict 2024",
 "egypt politics economy","morocco western sahara",
 "tunisia democracy transition","algeria politics",
 "libya post-conflict","yemen crisis humanitarian",
 "syria reconstruction","iraq political economy",
 "lebanon crisis reform","jordan refugees migration",
 "gulf states governance","saudi arabia vision 2030",
 "uae foreign policy","qatar diplomacy",
 "african union peacekeeping","ecowas regional integration",
 "arab league politics","gcc cooperation",
 "african migration europe","arab spring aftermath",
 "african literature contemporary","arabic literature modern",
 "african cinema film","african art contemporary",
 "decolonization africa","postcolonial arab world",
 "african feminism gender","women middle east",
 "african youth demographics","arab youth unemployment",
 "african urbanization cities","arab cities development",
 "african languages swahili","arabic language policy",
 "african philosophy ubuntu","islamic philosophy contemporary",
 "african history precolonial","arab history modern",
 "slavery africa transatlantic","african diaspora identity",
 "climate change africa adaptation","water security middle east",
 "agriculture africa food security","oil economy gulf states",
 "china africa relations belt road","russia middle east",
 "france africa francafrique","us middle east policy",
 "african conflicts peace","arab conflicts resolution",
 "terrorism africa boko haram","extremism middle east isis",
 "african democracy elections","arab democratization",
 "african human rights","human rights middle east",
 "african education systems","education reform arab world",
 "african health systems covid","health middle east",
 "african infrastructure development","infrastructure gulf",
 "african energy renewable","renewable energy mena"
 ],

 fr: [
 "afrique politique 2025","dÃ©veloppement africain",
 "monde arabe gÃ©opolitique","maghreb afrique nord",
 "sahel sÃ©curitÃ© terrorisme","afrique subsaharienne",
 "afrique ouest nigeria","afrique est kenya",
 "afrique centrale congo","afrique australe",
 "corne afrique Ã©thiopie","soudan conflit",
 "Ã©gypte politique Ã©conomie","maroc sahara occidental",
 "tunisie transition dÃ©mocratique","algÃ©rie politique",
 "libye reconstruction","syrie guerre civile",
 "liban crise Ã©conomique","golfe monarchies",
 "migration africaine europe","printemps arabe bilan",
 "littÃ©rature africaine contemporaine","littÃ©rature arabe moderne",
 "cinÃ©ma africain","francophonie afrique",
 "dÃ©colonisation afrique","postcolonial monde arabe",
 "fÃ©minisme africain","femmes monde arabe",
 "jeunesse africaine","jeunesse arabe chÃ´mage",
 "urbanisation afrique","villes arabes",
 "changement climatique afrique","eau moyen orient",
 "agriculture afrique sÃ©curitÃ© alimentaire","pÃ©trole golfe",
 "chine afrique relations","france afrique franÃ§afrique",
 "conflits africains paix","terrorisme sahel",
 "dÃ©mocratie afrique","droits homme afrique",
 "Ã©ducation afrique","santÃ© afrique",
 "infrastructure afrique","Ã©nergie renouvelable"
 ],

 ar: [
 "Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ© 2025","Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ©",
 "Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø³ÙŠØ§Ø³Ø©","Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø· Ø§Ù„Ø¬ÙŠÙˆØ³ÙŠØ§Ø³ÙŠØ©",
 "Ø§Ù„Ø³Ø§Ø­Ù„ Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ Ø§Ù„Ø£Ù…Ù†","Ø§Ù„Ù…ØºØ±Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø´Ù…Ø§Ù„ Ø£ÙØ±ÙŠÙ‚ÙŠØ§",
 "Ø§Ù„Ù‚Ø±Ù† Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§","Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„Ø´Ø±Ù‚ÙŠØ© ÙƒÙŠÙ†ÙŠØ§",
 "Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„ØºØ±Ø¨ÙŠØ© Ù†ÙŠØ¬ÙŠØ±ÙŠØ§","Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©",
 "Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„ÙˆØ³Ø·Ù‰ Ø§Ù„ÙƒÙˆÙ†ØºÙˆ","Ø§Ù„Ø³ÙˆØ¯Ø§Ù† Ø§Ù„ØµØ±Ø§Ø¹ 2024",
 "Ù…ØµØ± Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯","Ø§Ù„Ù…ØºØ±Ø¨ Ø§Ù„ØµØ­Ø±Ø§Ø¡ Ø§Ù„ØºØ±Ø¨ÙŠØ©",
 "ØªÙˆÙ†Ø³ Ø§Ù„Ø¯ÙŠÙ…Ù‚Ø±Ø§Ø·ÙŠØ© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„","Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ø§Ù„Ø³ÙŠØ§Ø³Ø©",
 "Ù„ÙŠØ¨ÙŠØ§ Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„ØµØ±Ø§Ø¹","Ø³ÙˆØ±ÙŠØ§ Ø§Ù„Ø­Ø±Ø¨ Ø§Ù„Ø£Ù‡Ù„ÙŠØ©",
 "Ù„Ø¨Ù†Ø§Ù† Ø§Ù„Ø£Ø²Ù…Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©","Ø§Ù„Ø£Ø±Ø¯Ù† Ø§Ù„Ù„Ø§Ø¬Ø¦ÙˆÙ†",
 "Ø§Ù„ÙŠÙ…Ù† Ø§Ù„Ø£Ø²Ù…Ø© Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ©","Ø§Ù„Ø¹Ø±Ø§Ù‚ Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ Ø§Ù„Ø³ÙŠØ§Ø³ÙŠ",
 "Ø¯ÙˆÙ„ Ø§Ù„Ø®Ù„ÙŠØ¬ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø­ÙƒÙ…","Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø±Ø¤ÙŠØ© 2030",
 "Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©","Ù‚Ø·Ø± Ø§Ù„Ø¯Ø¨Ù„ÙˆÙ…Ø§Ø³ÙŠØ©",
 "Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ Ø­ÙØ¸ Ø§Ù„Ø³Ù„Ø§Ù…","Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
 "Ø§Ù„Ù‡Ø¬Ø±Ø© Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ© Ø£ÙˆØ±ÙˆØ¨Ø§","Ø§Ù„Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø­ØµÙŠÙ„Ø©",
 "Ø§Ù„Ø£Ø¯Ø¨ Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ Ø§Ù„Ù…Ø¹Ø§ØµØ±","Ø§Ù„Ø£Ø¯Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø­Ø¯ÙŠØ«",
 "Ø§Ù„Ø³ÙŠÙ†Ù…Ø§ Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ©","Ø§Ù„ÙÙ† Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ Ø§Ù„Ù…Ø¹Ø§ØµØ±",
 "Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¹Ù…Ø§Ø± Ø£ÙØ±ÙŠÙ‚ÙŠØ§","Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø³ØªØ¹Ù…Ø§Ø± Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ",
 "Ø§Ù„Ù†Ø³ÙˆÙŠØ© Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ©","Ø§Ù„Ù…Ø±Ø£Ø© Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·",
 "Ø§Ù„Ø´Ø¨Ø§Ø¨ Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ Ø§Ù„Ø¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠØ§","Ø§Ù„Ø´Ø¨Ø§Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø¨Ø·Ø§Ù„Ø©",
 "Ø§Ù„ØªØ­Ø¶Ø± Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„Ù…Ø¯Ù†","Ø§Ù„Ù…Ø¯Ù† Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ØªÙ†Ù…ÙŠØ©",
 "Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ© Ø§Ù„Ø³ÙˆØ§Ø­Ù„ÙŠØ©","Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³ÙŠØ§Ø³Ø©",
 "Ø§Ù„ÙÙ„Ø³ÙØ© Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ© Ø£ÙˆØ¨ÙˆÙ†ØªÙˆ","Ø§Ù„ÙÙ„Ø³ÙØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ø§Ù„Ù…Ø¹Ø§ØµØ±Ø©",
 "ØªØ§Ø±ÙŠØ® Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ¹Ù…Ø§Ø±","Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ø­Ø¯ÙŠØ«",
 "Ø§Ù„Ø¹Ø¨ÙˆØ¯ÙŠØ© Ø£ÙØ±ÙŠÙ‚ÙŠØ§","Ø§Ù„Ø´ØªØ§Øª Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ Ø§Ù„Ù‡ÙˆÙŠØ©",
 "Ø§Ù„ØªØºÙŠØ± Ø§Ù„Ù…Ù†Ø§Ø®ÙŠ Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„ØªÙƒÙŠÙ","Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ù…Ø§Ø¦ÙŠ Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·",
 "Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„Ø£Ù…Ù† Ø§Ù„ØºØ°Ø§Ø¦ÙŠ","Ø§Ù„Ù†ÙØ· Ø§Ù‚ØªØµØ§Ø¯ Ø§Ù„Ø®Ù„ÙŠØ¬",
 "Ø§Ù„ØµÙŠÙ† Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª","Ø±ÙˆØ³ÙŠØ§ Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·",
 "ÙØ±Ù†Ø³Ø§ Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„ÙØ±Ù†ÙƒÙˆÙÙˆÙ†ÙŠØ©","Ø£Ù…Ø±ÙŠÙƒØ§ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·",
 "Ø§Ù„ØµØ±Ø§Ø¹Ø§Øª Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠØ© Ø§Ù„Ø³Ù„Ø§Ù…","Ø­Ù„ Ø§Ù„Ù†Ø²Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
 "Ø§Ù„Ø¥Ø±Ù‡Ø§Ø¨ Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø¨ÙˆÙƒÙˆ Ø­Ø±Ø§Ù…","Ø§Ù„ØªØ·Ø±Ù Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø· Ø¯Ø§Ø¹Ø´",
 "Ø§Ù„Ø¯ÙŠÙ…Ù‚Ø±Ø§Ø·ÙŠØ© Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª","Ø§Ù„Ø¯Ù…Ù‚Ø±Ø·Ø© Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ",
 "Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ø¥Ù†Ø³Ø§Ù† Ø£ÙØ±ÙŠÙ‚ÙŠØ§","Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ø¥Ù†Ø³Ø§Ù† Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·",
 "Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©","Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ",
 "Ø§Ù„ØµØ­Ø© Ø£ÙØ±ÙŠÙ‚ÙŠØ§ ÙƒÙˆÙÙŠØ¯","Ø§Ù„ØµØ­Ø© Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·",
 "Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„ØªÙ†Ù…ÙŠØ©","Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ¬Ø¯Ø¯Ø© Ø£ÙØ±ÙŠÙ‚ÙŠØ§"
 ]
};

// â”€â”€â”€ ÙƒØ´Ù Ø§Ù„Ù„ØºØ© â”€â”€â”€
function detectLang(text) {
 if (!text) return 'en';
 if (/[\u0600-\u06FF]/.test(text)) return 'ar';
 if (/[Ã Ã¢Ã©Ã¨ÃªÃ«Ã¯Ã®Ã´Ã¹Ã»Ã¼Ã¿Ã§Å“Ã¦]/i.test(text)) return 'fr';
 const frWords = /\b(le|la|les|du|des|une?|et|en|dans|politique|afrique|maghreb)\b/i;
 if (frWords.test(text)) return 'fr';
 return 'en';
}

// â”€â”€â”€ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹Ø§Øª â”€â”€â”€
function detectTopics(title, desc) {
 const text = ((title||'') + ' ' + (desc||'')).toLowerCase();
 const topics = [];
 const map = {
 'Ø£ÙØ±ÙŠÙ‚|africa|afrique|african': 'Africa',
 'Ø´Ù…Ø§Ù„ Ø£ÙØ±ÙŠÙ‚|Ø§Ù„Ù…ØºØ±Ø¨|north africa|maghreb|maghrÃ©bin': 'North Africa',
 'Ø³Ø§Ø­Ù„|sahel|mali|niger|burkina|tchad': 'Sahel',
 'Ø¹Ø±Ø¨|arab|arabe': 'Arab',
 'Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø·|middle east|moyen.orient': 'Middle East',
 'Ø®Ù„ÙŠØ¬|gulf|golfe|qatar|emirates|saudi|bahrain|kuwait|oman': 'Gulf',
 'Ø³ÙˆØ¯Ø§Ù†|sudan|soudan|darfur|khartoum': 'Sudan',
 'Ù‡Ø¬Ø±|migrat|diaspora': 'Migration',
 'Ø£Ù…Ù†|ØµØ±Ø§Ø¹|terror|conflict|conflit|securi|guerre|war|peace': 'Security',
 'ØªÙ†Ù…ÙŠ|develop|Ã©conomi|econom|Ø§Ù‚ØªØµØ§Ø¯|poverty': 'Development',
 'Ø³ÙŠØ§Ø³|politi|democra|Ø¯ÙŠÙ…Ù‚Ø±Ø§Ø·|govern|Ø­ÙƒÙ…|Ã©lection': 'Politics',
 'Ù…ØµØ±|egypt|Ã©gypt|cairo': 'Egypt',
 'Ù„ÙŠØ¨ÙŠ|libya|libye': 'Libya',
 'Ù…ØºØ±Ø¨|morocco|maroc': 'Morocco',
 'Ø¬Ø²Ø§Ø¦Ø±|algeria|algÃ©rie': 'Algeria',
 'ØªÙˆÙ†Ø³|tunisia|tunisie': 'Tunisia',
 'Ù†ÙŠØ¬ÙŠØ±ÙŠ|nigeria': 'Nigeria',
 'Ø¥Ø«ÙŠÙˆØ¨|ethiopia|Ã©thiop': 'Ethiopia',
 'ØµÙˆÙ…Ø§Ù„|somalia|somalie': 'Somalia',
 'ÙƒÙŠÙ†ÙŠ|kenya': 'Kenya',
 'ØªÙ†Ø²Ø§Ù†ÙŠ|tanzania|tanzanie': 'Tanzania',
 'ØºØ§Ù†Ø§|ghana': 'Ghana',
 'Ø³Ù†ØºØ§Ù„|senegal|sÃ©nÃ©gal': 'Senegal',
 'ÙƒÙˆÙ†ØºÙˆ|congo': 'Congo',
 'Ø¬Ù†ÙˆØ¨ Ø£ÙØ±ÙŠÙ‚ÙŠØ§|south africa|afrique sud': 'South Africa',
 'Ù„Ø¨Ù†Ø§Ù†|lebanon|liban': 'Lebanon',
 'Ø³ÙˆØ±ÙŠ|syria|syrie': 'Syria',
 'Ø¹Ø±Ø§Ù‚|iraq|irak': 'Iraq',
 'ÙŠÙ…Ù†|yemen|yÃ©men': 'Yemen',
 'Ø£Ø±Ø¯Ù†|jordan|jordanie': 'Jordan',
 'Ø¥Ø³Ù„Ø§Ù…|islam': 'Islam',
 'Ø§Ø³ØªØ¹Ù…Ø§Ø±|colonial|dÃ©coloni': 'Colonialism',
 'ØµÙŠÙ†|china|chine': 'China-Africa',
 'Ù…Ù†Ø§Ø®|climate|climat': 'Climate',
 'Ù†ÙØ·|oil|energy|Ù†Ø³Ø§Ø¡|Ø·Ø§Ù‚Ø©|pÃ©trole': 'Energy',
 'women|gender|femme|Ù†ÙˆØ¹ Ø§Ø¬ØªÙ…Ø§Ø¹': 'Gender',
 'Ø´Ø¨Ø§Ø¨|youth|jeunesse': 'Youth',
 'ØªØ¹Ù„ÙŠÙ…|education|Ã©ducation': 'Education',
 'ØµØ­Ø©|health|santÃ©': 'Health',
 'Ø£Ø¯Ø¨|literature|littÃ©rature': 'Literature',
 'Ø³ÙŠÙ†Ù…Ø§|cinema|cinÃ©ma': 'Cinema',
 };
 for (const [pattern, topic] of Object.entries(map)) {
 if (new RegExp(pattern, 'i').test(text)) topics.push(topic);
 }
 return topics.length ? topics.slice(0,4) : ['General'];
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù‘Ù†
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function normalizeTitle(title) {
 if (!title) return '';
 return title
 .toLowerCase()
 .trim()
 .replace(/[^\w\s\u0600-\u06FF]/g, ' ')
 .replace(/\s+/g, ' ')
 .replace(/\b(the|a|an|and|or|of|in|on|at|to|for|with|by|from|le|la|les|un|une|des|du|de|et|ÙÙŠ|Ù…Ù†|Ø¥Ù„Ù‰|Ø¹Ù„Ù‰|Ùˆ|Ø£Ùˆ)\b/gi, ' ')
 .replace(/\s+/g, ' ')
 .trim()
 .substring(0, 80);
}

function cleanISBN(isbn) {
 if (!isbn) return '';
 return isbn.replace(/[^0-9X]/gi, '');
}

function generateBookKey(book) {
 const keys = [];
 if (book.isbn && book.isbn.length >= 10) {
 const cleanedISBN = cleanISBN(book.isbn);
 if (cleanedISBN.length >= 10) {
  keys.push(`isbn:${cleanedISBN}`);
 }
 }
 const normTitle = normalizeTitle(book.title);
 if (normTitle && normTitle.length > 10) {
 const firstAuthor = book.authors && book.authors[0] ?
  normalizeTitle(book.authors[0]) : '';
 if (firstAuthor) {
  keys.push(`title-author:${normTitle}:${firstAuthor}`);
 } else {
  keys.push(`title:${normTitle}`);
 }
 }
 if (normTitle && book.publisher && book.publication_date) {
 const year = new Date(book.publication_date).getFullYear();
 if (year && year > 2000) {
  const normPublisher = normalizeTitle(book.publisher);
  keys.push(`title-pub-year:${normTitle}:${normPublisher}:${year}`);
 }
 }
 return keys;
}

function removeDuplicates(books) {
 const uniqueBooks = [];
 const seenKeys = new Set();
 let duplicateCount = 0;
 for (const book of books) {
 let isDuplicate = false;
 const keys = generateBookKey(book);
 for (const key of keys) {
  if (seenKeys.has(key)) {
  isDuplicate = true;
  duplicateCount++;
  break;
  }
 }
 if (isDuplicate) continue;
 uniqueBooks.push(book);
 for (const key of keys) {
  seenKeys.add(key);
 }
 }
 console.log(`âœ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±: ${books.length} â†’ ${uniqueBooks.length} (Ø­ÙØ°Ù ${duplicateCount} Ù…ÙƒØ±Ø±)`);
 return uniqueBooks;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ÙƒØªØ§Ø¨ Ù…Ù†Ø´ÙˆØ± Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ø¹Ø§Ù… (Ù„Ø§ ÙŠÙØ­Ø°Ù Ø­ØªÙ‰ ÙŠÙ…Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ø¹Ø§Ù…)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function isWithinOneYear(pubDate) {
 if (!pubDate) return false;
 const pub = new Date(pubDate).getTime();
 const oneYearAgo = Date.now() - (365 * 24 * 60 * 60 * 1000);
 return pub >= oneYearAgo;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø¬Ù„Ø¨ Ù…Ù† Google Books
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchGoogleBooks(query) {
 const books = [];
 try {
 const params = new URLSearchParams({
  q: query,
  printType: 'books',
  orderBy: 'newest',
  maxResults: '40',
 });
 const resp = await fetch(`https://www.googleapis.com/books/v1/volumes?${params}`);
 if (!resp.ok) return books;
 const data = await resp.json();

 for (const item of (data.items||[])) {
  const v = item.volumeInfo||{};
  const pubDate = v.publishedDate||'';

  // Ø§Ù„ÙƒØªØ§Ø¨ ÙŠØ¨Ù‚Ù‰ Ù…Ø§ Ø¯Ø§Ù… Ù„Ù… ÙŠÙ…Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ø¹Ø§Ù… Ø¹Ù„Ù‰ Ù†Ø´Ø±Ù‡
  if (!pubDate || !isWithinOneYear(pubDate)) continue;

  const lang = v.language==='ar'?'ar': v.language==='fr'?'fr': detectLang(v.title);

  books.push({
  id: item.id,
  title: v.title + (v.subtitle ? ': '+v.subtitle : ''),
  authors: v.authors||[],
  publisher: v.publisher||'',
  publication_date: pubDate,
  pages: v.pageCount||null,
  isbn: (v.industryIdentifiers||[]).find(i=>i.type==='ISBN_13')?.identifier
   || (v.industryIdentifiers||[]).find(i=>i.type==='ISBN_10')?.identifier || '',
  book_url: v.infoLink||v.previewLink||'',
  cover: (v.imageLinks?.thumbnail||v.imageLinks?.smallThumbnail||'').replace('http:','https:'),
  description: (v.description||'').substring(0,400),
  language: lang,
  topics: detectTopics(v.title, v.description),
  source: 'Google Books',
  rating: v.averageRating||null,
  });
 }
 } catch(e) { console.warn('Google Books error:', query, e); }
 return books;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø¬Ù„Ø¨ Ù…Ù† Open Library
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchOpenLibrary(query) {
 const books = [];
 try {
 const params = new URLSearchParams({ q: query, limit: '30', sort: 'new' });
 const resp = await fetch(`https://openlibrary.org/search.json?${params}`);
 if (!resp.ok) return books;
 const data = await resp.json();
 const oneYearAgoYear = new Date().getFullYear() - 1;

 for (const doc of (data.docs||[])) {
  const year = doc.first_publish_year || 0;
  if (year < oneYearAgoYear) continue;

  // ØªØ­Ù‚Ù‚ Ø¥Ø¶Ø§ÙÙŠ: Ù‡Ù„ Ù…Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ø¹Ø§Ù…ØŸ
  const pubDateStr = year ? year+'-01-01' : '';
  if (!isWithinOneYear(pubDateStr)) continue;

  const coverId = doc.cover_i;

  books.push({
  id: 'ol_'+doc.key,
  title: doc.title||'',
  authors: doc.author_name||[],
  publisher: (doc.publisher||[])[0]||'',
  publication_date: pubDateStr,
  pages: doc.number_of_pages_median||null,
  isbn: (doc.isbn||[])[0]||'',
  book_url: 'https://openlibrary.org'+doc.key,
  cover: coverId ? `https://covers.openlibrary.org/b/id/${coverId}-M.jpg` : '',
  description: '',
  language: detectLang(doc.title),
  topics: detectTopics(doc.title, (doc.subject||[]).join(' ')),
  source: 'Open Library',
  rating: null,
  });
 }
 } catch(e) { console.warn('Open Library error:', query, e); }
 return books;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchAllBooks() {
 document.getElementById('progressBar').style.display = 'block';
 document.getElementById('refreshBtn').disabled = true;
 document.getElementById('booksGrid').innerHTML =
 '<div class="loader"><div class="spinner"></div><p>Ø¬Ø§Ø±Ù Ø¬Ù„Ø¨ Ø§Ù„ÙƒØªØ¨ Ù…Ù† +120 Ù…ØµØ¯Ø±...</p></div>';

 const allBooks = [];

 const allQueries = [
 ...QUERIES.en.map(q => ({ q, lang:'en', api:'google' })),
 ...QUERIES.fr.map(q => ({ q, lang:'fr', api:'google' })),
 ...QUERIES.ar.map(q => ({ q, lang:'ar', api:'google' })),
 ...QUERIES.en.slice(0,20).map(q => ({ q, lang:'en', api:'openlibrary' })),
 ];

 const totalSteps = allQueries.length;
 let step = 0;

 for (const { q, api } of allQueries) {
 step++;
 updateProgress(step, totalSteps, `${api}: ${q.substring(0,35)}...`);

 let books = [];
 if (api === 'google') books = await fetchGoogleBooks(q);
 else if (api === 'openlibrary') books = await fetchOpenLibrary(q);

 allBooks.push(...books);
 await sleep(300);
 }

 updateProgress(totalSteps, totalSteps, 'Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±...');

 console.log(`ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„ØªÙƒØ±Ø§Ø±: ${allBooks.length}`);
 ALL_BOOKS = removeDuplicates(allBooks);

 // ØªÙ†Ø¸ÙŠÙ Ø¥Ø¶Ø§ÙÙŠ: Ø­Ø°Ù Ø£ÙŠ ÙƒØªØ§Ø¨ Ù…Ø± Ø¹Ù„Ù‰ Ù†Ø´Ø±Ù‡ Ø£ÙƒØ«Ø± Ù…Ù† Ø¹Ø§Ù…
 ALL_BOOKS = ALL_BOOKS.filter(b => isWithinOneYear(b.publication_date));

 console.log(`ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙƒØ±Ø§Ø± ÙˆØ§Ù„ØªÙ†Ø¸ÙŠÙ: ${ALL_BOOKS.length}`);

 ALL_BOOKS.sort((a,b) => new Date(b.publication_date) - new Date(a.publication_date));

 try {
 localStorage.setItem('africa_arab_books_v3', JSON.stringify({
  books: ALL_BOOKS,
  timestamp: Date.now()
 }));
 } catch(e) {}

 document.getElementById('progressBar').style.display = 'none';
 document.getElementById('refreshBtn').disabled = false;

 updateStats();
 filterBooks();
 updateLastTime();
}

function sleep(ms) { return new Promise(r=>setTimeout(r,ms)); }

function updateProgress(current, total, source) {
 const pct = Math.round((current/total)*100);
 document.getElementById('progressFill').style.width = pct+'%';
 document.getElementById('progressText').textContent = `ğŸ“¥ ${pct}% â€” ${source}`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„ÙÙ„ØªØ±Ø© ÙˆØ§Ù„Ø¹Ø±Ø¶
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setLang(lang, btn) {
 currentLang = lang;
 document.querySelectorAll('.filter-btn').forEach(b => b.className = 'filter-btn');
 if (lang==='all') btn.classList.add('active');
 else if (lang==='ar') btn.classList.add('active-ar');
 else if (lang==='fr') btn.classList.add('active-fr');
 else if (lang==='en') btn.classList.add('active-en');
 filterBooks();
}

function filterBooks() {
 const search = document.getElementById('searchInput').value.toLowerCase();
 const topic = document.getElementById('topicSelect').value;
 const sort = document.getElementById('sortSelect').value;

 let filtered = ALL_BOOKS.filter(b => {
 if (currentLang!=='all' && b.language!==currentLang) return false;
 if (topic && !b.topics.some(t=>t.toLowerCase().includes(topic.toLowerCase()))) return false;
 if (search) {
  const hay = (b.title+' '+b.authors.join(' ')+' '+b.publisher).toLowerCase();
  if (!hay.includes(search)) return false;
 }
 return true;
 });

 if (sort==='title') filtered.sort((a,b)=>a.title.localeCompare(b.title,'ar'));
 else if (sort==='pages') filtered.sort((a,b)=>(b.pages||0)-(a.pages||0));
 else filtered.sort((a,b)=>new Date(b.publication_date)-new Date(a.publication_date));

 renderBooks(filtered);
}

function renderBooks(books) {
 const grid = document.getElementById('booksGrid');

 if (!books.length) {
 grid.innerHTML = '<div class="no-results"><div class="emoji">ğŸ“š</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒØªØ¨ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</p></div>';
 return;
 }

 grid.innerHTML = books.map(b => {
 const langClass = `lang-${b.language}`;
 const langLabel = b.language==='ar'?'Ø¹Ø±Ø¨ÙŠ': b.language==='fr'?'FranÃ§ais':'English';

 const date = b.publication_date ?
  new Date(b.publication_date).toLocaleDateString('en-US', {
  year:'numeric', month:'short', day:'numeric'
  }) : '';

 const coverHTML = b.cover
  ? `<img src="${b.cover}" alt="${escHtml(b.title)}" onerror="this.src='https://placehold.co/140x190/1a1a2e/ffffff?text=ğŸ“–'">`
  : `<div style="width:120px;height:170px;background:rgba(255,255,255,.08);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:3em;color:rgba(255,255,255,.3)">ğŸ“–</div>`;

 return `
  <div class="book-card">
  <div class="book-cover-wrap">
   ${coverHTML}
   <span class="lang-badge ${langClass}">${langLabel}</span>
   <span class="source-badge">${escHtml(b.source)}</span>
  </div>
  <div class="book-body" dir="rtl">
   <div class="book-title">${escHtml(b.title)}</div>
   <div class="book-author">âœ ${escHtml(b.authors.slice(0,3).join('ØŒ ')||'ØºÙŠØ± Ù…Ø­Ø¯Ø¯')}</div>
   <div class="book-publisher">ğŸ¢ ${escHtml(b.publisher||'ØºÙŠØ± Ù…Ø­Ø¯Ø¯')}</div>
   <div class="book-meta">
   ${date ? `<span>ğŸ“… ${date}</span>` : ''}
   ${b.pages ? `<span>ğŸ“„ ${b.pages} ØµÙØ­Ø©</span>` : ''}
   ${b.rating ? `<span>â­ ${b.rating.toFixed(1)}</span>` : ''}
   ${b.isbn ? `<span>ğŸ“‹ ${b.isbn}</span>` : ''}
   </div>
   <div class="book-topics">
   ${b.topics.slice(0,4).map(t=>`<span class="topic-tag">${escHtml(t)}</span>`).join('')}
   </div>
   ${b.description ? `<div class="book-desc">${escHtml(b.description)}</div>` : ''}
   <div class="book-actions">
   <a href="${escHtml(b.book_url)}" target="_blank" rel="noopener" class="btn-link btn-primary">ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒØªØ§Ø¨</a>
   ${b.isbn ? `<a href="https://www.worldcat.org/isbn/${b.isbn}" target="_blank" rel="noopener" class="btn-link btn-secondary">ğŸ“š WorldCat</a>` : ''}
   </div>
  </div>
  </div>`;
 }).join('');
}

function escHtml(s) {
 const d = document.createElement('div');
 d.textContent = s||'';
 return d.innerHTML;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateStats() {
 document.getElementById('totalCount').textContent = ALL_BOOKS.length;
 document.getElementById('arCount').textContent = ALL_BOOKS.filter(b=>b.language==='ar').length;
 document.getElementById('frCount').textContent = ALL_BOOKS.filter(b=>b.language==='fr').length;
 document.getElementById('enCount').textContent = ALL_BOOKS.filter(b=>b.language==='en').length;
 document.getElementById('sourceCount').textContent = SOURCES_LIST.length;
 const pubs = new Set(ALL_BOOKS.map(b=>b.publisher).filter(Boolean));
 document.getElementById('pubCount').textContent = pubs.size;
}

function updateLastTime() {
 document.getElementById('lastUpdate').textContent = 'Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ' +
 new Date().toLocaleString('en-US', {
  year:'numeric', month:'short', day:'numeric',
  hour:'2-digit', minute:'2-digit'
 });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§ØµØ¯
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleSources() {
 const el = document.getElementById('sourcesList');
 el.classList.toggle('open');
 if (el.classList.contains('open') && !el.innerHTML) {
 el.innerHTML = SOURCES_LIST.map((s,i) => `${i+1}. ${s}`).join('<br>');
 }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙŠØ¯ÙˆÙŠ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function manualRefresh() {
 localStorage.removeItem('africa_arab_books_v3');
 fetchAllBooks();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙƒØ§Ø´ Ù…Ù† Ø§Ù„ÙƒØªØ¨ Ø§Ù„ØªÙŠ Ù…Ø± Ø¹Ù„ÙŠÙ‡Ø§ Ø£ÙƒØ«Ø± Ù…Ù† Ø¹Ø§Ù…
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function cleanExpiredBooks(books) {
 return books.filter(b => isWithinOneYear(b.publication_date));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© - ØªØ­Ø¯ÙŠØ« ÙŠÙˆÙ…ÙŠ (ÙƒÙ„ 24 Ø³Ø§Ø¹Ø©)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(async function init() {
 try {
 const cache = JSON.parse(localStorage.getItem('africa_arab_books_v3'));
 if (cache && (Date.now() - cache.timestamp) < CACHE_DURATION) {
  // ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© (Ø£ÙƒØ«Ø± Ù…Ù† Ø¹Ø§Ù…) Ø­ØªÙ‰ Ù…Ù† Ø§Ù„ÙƒØ§Ø´
  ALL_BOOKS = cleanExpiredBooks(cache.books);
  updateStats();
  filterBooks();
  updateLastTime();
  console.log('âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„ÙƒØ§Ø´', ALL_BOOKS.length, 'ÙƒØªØ§Ø¨');

  // Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ù„ÙŠ Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙƒØ§Ø´
  const remaining = CACHE_DURATION - (Date.now() - cache.timestamp);
  setTimeout(() => fetchAllBooks(), remaining);
  return;
 }
 } catch(e) {}
 await fetchAllBooks();
})();

// ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 24 Ø³Ø§Ø¹Ø©
setInterval(() => {
 console.log('ğŸ”„ ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙŠÙˆÙ…ÙŠ...');
 fetchAllBooks();
}, CACHE_DURATION);
</script>
</body>
</html>
